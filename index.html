<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>debates legislativas 2024</title>
        <style>
            body {
                font-family: sans-serif;
            }

            button {
                display: inline-block;
                margin-left: 10px;
            }

            li span {
                display: inline-block;
                width: 120px;
            }

            #progress {
                width: 600px;
            }
        </style>
    </head>
    <body>
        <ul>
            <li>5 fev (2a)</li>
            <ul>
                <li>
                    <span>PAN - CHEGA</span><button onclick="run('2024-02-05_pan-chega')">play</button>
                </li>
                <li>
                    <span>PS - IL</span><button onclick="run('2024-02-05_ps-il')">play</button>
                </li>
            </ul>
        </ul>

        <div>
            <span id="time">0:00</span> / <span id="duration">0:00</span>
            <button id="toggle-play">⏯️</button><input id="progress" type="range" step="1" value="0">
        </div>
        
        <div id="content"></div>

        <script src="player.js"></script>
        <script>
            const timeEl = document.getElementById('time');
            const durationEl = document.getElementById('duration');
            const togglePlayEl = document.getElementById('toggle-play');
            const progressEl = document.getElementById('progress');
            const contentEl = document.getElementById('content');

            async function run(name) {
                const p = await player(name);
                const audio = p.audio;

                const onDuration = () => {
                    const d = audio.duration;
                    durationEl.innerHTML = humanTime(d);
                    progressEl.max = Math.ceil(d);
                }

                if (audio.duration) onDuration();
                audio.addEventListener('loadedmetadata', onDuration);
                audio.addEventListener('timeupdate', () => {
                    const t = audio.currentTime;
                    const ti = Math.round(t);
                    const ts = humanTime(ti);
                    if (timeEl.innerHTML != ts) timeEl.innerHTML = ts;
                    if (ti != progressEl.value) progressEl.value = ti;
                });

                progressEl.addEventListener('change', () => {
                    audio.currentTime = progressEl.value;
                });

                togglePlayEl.addEventListener('click', () => {
                    audio.paused ? audio.play() : audio.pause();
                });

                p.play();

                //window.a = audio;
            }
        </script>
    </body>
</html>